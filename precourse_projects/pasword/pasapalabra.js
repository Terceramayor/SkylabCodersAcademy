let questions = [

    [   { letter: "a", answer: "abducir", status: 0, question: "CON LA A. Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien"},
        { letter: "a", answer: "abdicar", status: 0, question: "CON LA A. Renunciar a una dignidad, cargo o un derecho"},
        { letter: "a", answer: "acrópolis", status: 0, question: "CON LA A. Lugar mñas alto y mejor fortificado de la población en las ciudades de la antigüedad" }],

    [   { letter: "b", answer: "bingo", status: 0, question: "CON LA B. Juego que ha sacado de quicio a todos los 'Skylabers' en las sesiones de precurso"},
        { letter: "b", answer: "burguesía", status: 0, question: "CON LA B. Clase social formada por las personas que tienen medios económicos o empresas"},
        { letter: "b", answer: "berlanga", status: 0, question: "CON LA B. Apellido del director de cine Español, autor de Bienvenido Mister Marshall"}],

    [   { letter: "c", answer: "churumbel", status: 0, question: "CON LA C. Niño, crío, bebé"},
        { letter: "c", answer: "ce", status: 0, question: "CON LA C. Nombre de la tercera letra del abecedario"},
        { letter: "c", answer: "cariátide", status: 0, question: "CON LA C. Estatua de mujer con traje talar, que hace función de columna"}],

    [   { letter: "d", answer: "diarrea", status: 0, question: "CON LA D. Anormalidad en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida"},
        { letter: "d", answer: "do", status: 0, question: "CON LA D. Nota musical"},
        { letter: "d", answer: "dadaísmo", status: 0, question: "CON LA D. Movimiento vanguardista surgido durante la Primera Guerra Mundial, que niega todo ideal artístico y reivindica las formas irracionales de la expresión"}],

    [   { letter: "e", answer: "ectoplasma", status: 0, question: "CON LA E. Gelatinoso y se encuentra debajo de la membrana plasmática. Los cazafantasmas medían su radiación"},
        { letter: "e", answer: "empollón", status: 0, question: "CON LA E. Que estudia mucho"},
        { letter: "e", answer: "eros", status: 0, question: "CON LA E. Dios griego del amor"}],

    [   { letter: "f", answer: "facil", status: 0, question: "CON LA F. Que no requiere gran esfuerzo, capacidad o dificultad"},
        { letter: "f", answer: "fe", status: 0, question: "CON LA F. Conjunto de creencias de una religión o doctrina"},
        { letter: "f", answer: "fotografía", status: 0, question: "CON LA F. Arte cuya etimología lo describe como -escritura con luz-"}],

    [   { letter: "g", answer: "galaxia", status: 0, question: "CON LA G. Conjunto enorme de estrellas, polvo interestelar, gases y partículas"},
        { letter: "g", answer: "génesis", status: 0, question: "CON LA G. Principio u origen de una cosa"},
        { letter: "g", answer: "gulag", status: 0, question: "CON LA G. Campo de concentración de la antigua Unión Soviética"}],

    [   { letter: "h", answer: "harakiri", status: 0, question: "CON LA H. Suicidio ritual japonés por desentrañamiento"},
        { letter: "h", answer: "helicoidal", status: 0, question: "CON LA H. Que tiene forma de hélice"},
        { letter: "h", answer: "holocausto", status: 0, question: "CON LA H: Exterminio sistemático de judíos y de otros grupos humanos llevado a cabo por el régimen de la Alemania nazi"}],

    [   { letter: "i", answer: "iglesia", status: 0, question: "CON LA I. Templo cristiano"},
        { letter: "i", answer: "indefinible", status: 0, question: "CON LA I. Que no se puede definir"},
        { letter: "i", answer: "iliada", status: 0, question: "CON LA I. Nombre del poema por entero conservado, perteneciente al ciclo Troyano, que narra la cólera de aquiles durante el último año de la gerra de Troya"}],

    [   { letter: "j", answer: "jabali", status: 0, question: "CON LA J. Variedad salvaje del cerdo que sale en la película 'El Rey León', de nombre Pumba"},
        { letter: "j", answer: "jocoso", status: 0, question: "CON LA J. Gracioso, chistoso, festivo"},
        { letter: "j", answer: "jupiter", status: 0, question: "CON LA J. Dios romano y planeta del sistema solar"}],

    [   { letter: "k", answer: "kamikaze", status: 0, question: "CON LA K. Persona que se juega la vida realizando una acción temeraria"},
        { letter: "k", answer: "kilometro", status: 0, question: "CON LA K. 1000 metros"},
        { letter: "k", answer: "kendo", status: 0, question: "CON LA K. Técnica de lucha de origen Japones, similar a la esgrima"}],

    [   { letter: "l", answer: "licantropo", status: 0, question: "CON LA L. Hombre lobo"},
        { letter: "l", answer: "lava", status: 0, question:"CON LA L. materia fundida e incandescente que surge de un volcán en erupción"},
        { letter: "l", answer: "leningrado", status: 0, question: "CON LA L. Nombre de la ciudad rusa de San Petersburgo entre 1924 y 1991"}],

    [   { letter: "m", answer: "misantropo", status: 0, question: "CON LA M. Persona que huye del trato con otras personas o siente gran aversión hacia ellas"},
        { letter: "m", answer: "megalómano", status: 0, question: "CON LA M. Que tiene un excesivo deseo de grandeza"},
        { letter: "m", answer: "milosevic", status: 0, question: "CON LA M. Presidente de Servia durante la guerra de los Balcanes entre el 1991 y 2001"}],

    [   { letter: "n", answer: "necedad", status: 0, question: "CON LA N. Demostración de poca inteligencia"},
        { letter: "n", answer: "no", status: 0, question: "CON LA N. Contrario de si"},
        { letter: "n", answer: "nerdo", status: 0, question: "CON LA N. Persona estudiosa e inteligente que suele mostrar un carácter abstraído y poco sociable"}],

    [   { letter: "ñ", answer: "Ñu", status: 0, question: "CON LA Ñ. Mamífero rumiante africano de la familia de los antílopes, de color pardo grisáceo, cuya cabeza recuerda la de un toro"},
        { letter: "ñ", answer: "ñoño", status: 0, question:"CON LA Ñ. Que es muy simple, tínido y apocado"},
        { letter: "ñ", answer: "año", status: 0, question: "CONTIENE LA Ñ. Duración del periodo de traslación terrestre"}],

    [   { letter: "o", answer: "orco", status: 0, question: "CON LA O. Humanoide fantástico de apariencia terrible y bestial, piel de color verde creada por el escritor Tolkien"},
        { letter: "o", answer: "oda", status: 0, question: "CON LA O. Poema extenso dividido en estrofas de asuntos diversos"},
        { letter: "o", answer: "opus", status: 0, question:"CON LA O. Palabra latina que se utiliza, seguida de un número, para clasificar las obras musicales en función de su fecha de escritura"}],

    [   { letter: "p", answer: "protoss", status: 0, question: "CON LA P. Raza ancestral tecnológicamente avanzada que se caracteriza por sus grandes poderes psíonicos del videojuego StarCraft"},
        { letter: "p", answer: "petulante", status: 0, question: "CON LA P. Que tiene una vana y exagerada presunción"},
        { letter: "p", answer: "petrogrado", status: 0, question: "CON LA P. Nombre de la ciudad rusa de San Petersburgo entre 1914 y 1924"}],

    [   { letter: "q", answer: "queso", status: 0, question: "CON LA Q. Producto obtenido por la maduración de la cuajada de la leche"},
        { letter: "q", answer: "quilo", status: 0, question: "CON LA Q. 1000 gramos"},
        { letter: "q", answer: "quechua", status: 0, question: "CON LA Q. Lengua de origen Inca, aún viva, cuya escritura no se formalizó hasta el siglo XX"}],

    [   { letter: "r", answer: "raton", status: 0, question: "CON LA R. Roedor"},
        { letter: "r", answer: "robot", status: 0, question: "CON LA R: Máquina o ingenio electrónico programable que es capaz de manipular objetos y realizar diversas operaciones"},
        { letter: "r", answer: "rembrandt", status: 0, question: "CON LA R. Pintor Neerlandés autor de la ronda de noche "}],

    [   { letter: "s", answer: "stackoverflow", status: 0, question: "CON LA S. Comunidad salvadora de todo desarrollador informático"},
        { letter: "s", answer: "sociología", status: 0, question: "CON LA S. Ciencia que estudia la formación, el desarrollo y las características de las sociedades humanas"},
        { letter: "s", answer: "sempiterno", status: 0, question: "CON LA S. Que habiendo tenido principio, no tiene fin"}],

    [   { letter: "t", answer: "terminator", status: 0, question: "CON LA T. Película del director James Cameron que consolidó a Arnold Schwarzenegger como actor en 1984"},
        { letter: "t", answer: "tácito", status: 0, question: "CON LA T. Que se supone, entiende o sobreentiende"},
        { letter: "t", answer: "tarantela", status: 0, question: "CON LA T.  Baile napolitano de movimiento muy vivo, en compás de seis por ocho, que se baila por parejas y con el acompañamiento de castañuelas y panderetas"}],

    [   { letter: "u", answer: "unamuno", status: 0, question: "CON LA U. Escritor y filósofo español de la generación del 98 autor del libro 'Niebla' en 1914"},
        { letter: "u", answer: "universidad", status: 0, question:"CON LA U. Institución que se dedica a la enseñanza superior"},
        { letter: "u", answer: "ulises", status: 0, question:"CON LA U. Heroe griego también referido como Odiseo"}],

    [   { letter: "v", answer: "vikingos", status: 0, question: "CON LA V. Nombre dado a los miembros de los pueblos nórdicos originarios de Escandinavia, famosos por sus incursiones y pillajes en Europa"},
        { letter: "v", answer: "velamen", status: 0, question: "CON LA V. Conjunto de velas de una embarcación"},
        { letter: "v", answer: "valquiria", status: 0, question: " CON LA V.  Cada una de ciertas divinidades de la mitología escandinava que en los combates designaban los héroes que habían de morir, y en el cielo les servían de escanciadoras"}],

    [   { letter: "w", answer: "sandwich", status: 0, question: "CONTIENE LA W. Emparedado hecho con dos rebanadas de pan entre las cuales se coloca jamón y queso"},
        { letter: "w", answer: "Web", status: 0, question: "CON LA W. Red informática"},
        { letter: "w", answer: "Wagner", status: 0, question: "CON LA W. Compositor aleman del siglo XIX, auntor de el anillo del Nibelungo"}],

    [   { letter: "x", answer: "botox", status: 0, question: "CONTIENE LA X. Toxina bacteriana utilizada en cirujía estética"},
        { letter: "x", answer: "xenofobia", status: 0, question: "CON LA X. Sentimiento de odio hacia el extrangero"},
        { letter: "x", answer: "xenon", status: 0, question: "CON LA X. Elemento nº 54 de la tabla periódica"}],

    [   { letter: "y", answer: "peyote", status: 0, question: "CONTIENE LA Y. Pequeño cáctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal  por indígenas americanos"},
        { letter: "y", answer: "yeti", status: 0, question: "CON LA Y. Ser fantástico y monstruoso con figura humana que según ciertas leyendas habita el Himalaya"},
        { letter: "y", answer: "yiddish", status: 0, question: "CON LA Y. Lengua hablada por los judios de origen aleman, formada por elementos del Hebreo, alto Aleman, Francés antiguo y dialectos del norte de Italia"}],

    [   { letter: "z", answer: "zen", status: 0, question: "CON LA Z. Escuela de budismo que busca la experiencia de la sabiduría más allá del discurso racional"},
        { letter: "z", answer: "zafarse", status: 0, question: "CON LA Z. Espapar o esconderse para evitar un encuentro o un peligro"},
        { letter: "z", answer: "zaratustra", status: 0, question: "CON LA Z. Profeta persa y principal protagonista de cierto poemario folosófico escrito por Nietzsche"}]]

let remaining;

function ini() {  //Esta función pide el nombre del usuario
    
    let dim=0;

    let name = prompt(`WELCOME THE TO SKYLAB PASAPALABRA GAME.TO BEGIN, PLEASE STATE YOUR NAME: `, `name?`);

    for (let i=0; i<name.length;i++){       //Comprobamos si se han introducido solo espacios

        dim = (name.charAt(i)===" ") ? dim+1:dim ;
        
    }
    
    if (dim===name.length){

        dim = -1;
        
    } else {

        dim = 0;

    } while (typeof(name)!="string" || name==="name?" || 0 === name.length || dim===-1 || name==="null"){

        dim = 0;

        debugger

        console.log(`Please insert a valid name!`)
        name = prompt(`WELCOME THE TO SKYLAB PASAPALABRA GAME.TO BEGIN, PLEASE STATE YOUR NAME: `, `name?`);

        for (let i=0; i<name.length;i++){       //Comprobamos si se han introducido solo espacios

            dim = (name.charAt(i)===" ") ? dim+1:dim ;
            
        }
        
        if (dim===name.length){
    
            dim = -1;
                
        } else {

            dim=0;

        }

    }

    console.log(`Hello ${name}!`)

    return name;

}

function word(letterNum,level,questions){   //Esta función presenta en la pantalla la pregunta correspondiente

      response = prompt(`${questions[letterNum][level].question}`,`Your answer`);

return response;

}

function check(letterNum,level,questions,response,stopcondition){   //Esta función se encarga de comprobar si la respuesta introducida es correcta, en cuyo caso cambia el "status" de la palabra a "1"

    if (response==null){

    stopcondition=true;

    let points = 0; 
    
    points = score(questions, points);
    scoreReset(questions);

    console.log(`Game finished by the user. You made ${points} in this game, though it won't enter the ranking!`)

    return stopcondition;

    } else if (questions[letterNum][level].answer.toLowerCase()==response.toLowerCase()){

        console.log(`\n\n\nCORRECT FOR ${questions[letterNum][level].letter.toUpperCase()}: ${response.toLowerCase()} !\n\n\n`);

        questions[letterNum][level].status="correct";
        remaining=remaining-1;
        
        return stopcondition;

    } else if (response.toLowerCase()=="end") {

        stopcondition=true;

        let points = 0; 
    
        points = score(questions, points);
        scoreReset(questions);

        console.log(`Game finished by the user. You made ${points} in this game, though it won't enter the ranking!`)

        return stopcondition;

    } else if(response.toLowerCase()=="pasapalabra"){

        console.log(`Word skipped!!`)

        return stopcondition;

    }
        
    else {

        console.log(`\n\n\nINCORRECT ASNWER FOR ${questions[letterNum][level].letter.toUpperCase()}. ${questions[letterNum][level].question} -> ${questions[letterNum][level].answer}\n\n\n`);

        questions[letterNum][level].status="incorrect";

        remaining=remaining-1;

        return stopcondition;

    }

}

function score(questions, result){      //Esta función calcula la puntuación
    
result=0;

    for (let i=0; i<questions.length; i++){

        for (let j=0; j<questions[i].length; j++){

            if (questions[i][j].status=="correct"){
                result++;
                
            }
        
        }

    }   

    return result;

}

function variety(){     //Función pide al usuario elegir el nivel de difficultad entre tres posibles

    level = parseInt(prompt("Please select the difficulty level [1-2-3]"))-1;
    
    while (level!==0 && level!==1 && level!==2){

        console.log("Please introduce a valid difficulty level");
        level = parseInt(prompt("Please select the difficulty level [1-2-3]"))-1;

    }

    return level;

}

function player (name, result) {       //Eesta funcion genera un objeto con el nombre del jugador y su puntuación final. Se utilizará para generar el ranking

    this["Player Name"]=name;
    this["Score"]=result;

}

function ranking(rank, name, result) {         //Esta función se ecarga de introducir el jugador en el rankig

    let currentPlayer = new player(name, result)

    if (rank.length==0){    // Si aún no hay ningún jugador en el ranking, se añade directamente los resultados de la primera partida

        rank[0] = currentPlayer;
        
        return rank

    }

    for (let i=0; i<rank.length;i ++){       //Buscamos si el jugador ya aparece en el ranking y, de ser así, si la punruación obtenida en la partida actual es mayor, actualizamos su puntuación.
        
            if ( rank[i]["Player Name"]==name) {           // Si el jugador ya aparece en el ranking...

            if ( rank[i]["Score"] < result ) {          //Y ademas la puntuación en la partida actual es mayor que la que aparece en el ranking, actualizamos la puntuación

            rank[i] = currentPlayer;

            return rank

            } else {        //Si la puntuación en la partida actual es menor que la que ya aperece en el ranking, no hacemos nada

            return rank

            }

        }   else if (i==rank.length-1){      //Si el jugador aún no ha aparecido en el ranking, se añade al final

                rank.push(currentPlayer);

                return rank

        }

    }

}

function sortRanking(rank) {        // Esta función se encarga de reordenar el ranking

    rank=rank.sort(function(a,b){return (b["Score"]-a["Score"]);});       //Ordenamos el array del ranking por puntuación

    console.log(`Here you have the ranking:\n\n`);

    console.table(rank);

    return rank

}

function scoreReset(questions){      //Esta funcion pone de nuevo el estatus de to cada palabra a "0". Se invoca al inicio de pada partida.
        
        for (let i=0; i<questions.length; i++){
    
            for (let j=0; j<questions[i].length; j++){
    
                questions[i][j].status="unanswered";
            
            }
    
        }   
    
        return questions;
    
    }

function pasapalabra(){     //Esta es la función principal que controla la ejecución del programa

let name="";
let response="";
let result;
let level;
let stopcondition=false;
let roundControl=false;


let rank=[];

while (stopcondition==false) {

    letterNum = 0;

    if(roundControl===false){

        remaining = 27;

        scoreReset(questions);
        
        console.clear();

        name = ini();

        level = variety();

        console.log("Game initiated, good luck!");
    
    } else {

        letterNum=0;

        while(questions[letterNum][level].status=="incorrect" || questions[letterNum][level].status=="correct"){

            letterNum = (letterNum===27) ? 0 : letterNum +1;

        }
        
    }

    do {

        response = word(letterNum,level,questions);
        
        stopcondition = check(letterNum,level,questions,response,stopcondition);
        
        letterNum = (letterNum===26) ? 0 : letterNum +1;

        if (remaining!==0){

            while((questions[letterNum][level].status=="incorrect" || questions[letterNum][level].status=="correct")){

                letterNum = (letterNum===26) ? 0 : letterNum +1;

            }
            
        }

    } while (letterNum<questions.length && stopcondition==false && remaining!==0)

    if(stopcondition===false){

        result=score(questions, result);
        ranking(rank, name, result);
        sortRanking(rank)

    } 

        stopcondition = window.confirm("Would you like to play again?")? false : true;  

        stopcondition==true? console.log("Bye bye!") : console.log("") ;

}

return;

}

pasapalabra();